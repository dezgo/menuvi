{% extends "base.html" %}

{% block title %}My Picks â€” {{ restaurant_name }}{% endblock %}

{% block body %}
<header class="topbar">
  <a href="{{ url_for('public.landing') }}" class="topbar-back">&#8592; Menu</a>
  <span class="topbar-title">My Picks</span>
  <span style="width:70px"></span>
</header>

<main class="container picks-page" id="picks-container">
  {% if by_category %}
    {% for cat_name, items in by_category.items() %}
    <div class="picks-group">
      <h3>{{ cat_name }}</h3>
      {% for item in items %}
      <div class="pick-item">
        <div>
          <span class="pick-name">{{ item.name }}</span>
          {% if item.price_display %}
          <span class="pick-price">{{ item.price_display }}</span>
          {% endif %}
        </div>
        <form method="post" action="{{ url_for('public.pick_remove', item_id=item.id) }}">
          <button type="submit" class="btn btn-sm btn-danger">&#10005;</button>
        </form>
      </div>
      {% endfor %}
    </div>
    {% endfor %}

    <div class="picks-actions">
      <button type="button" class="btn" id="show-waiter-btn" onclick="toggleShowMode()">
        Show Waiter
      </button>
      <form method="post" action="{{ url_for('public.picks_clear') }}">
        <button type="submit" class="btn btn-danger">Clear All</button>
      </form>
    </div>
  {% else %}
    <div class="picks-empty">
      <p style="font-size:1.3rem; margin-bottom:0.5rem;">No picks yet</p>
      <p>Browse the menu and tap <strong>+ Pick</strong> on items you'd like to order.</p>
      <a href="{{ url_for('public.landing') }}" class="btn" style="margin-top:1.5rem;">View Menu</a>
    </div>
  {% endif %}
</main>

{% include "public/_bottom_nav.html" %}
{% endblock %}

{% block scripts %}
<script>
function toggleShowMode() {
  const el = document.getElementById('picks-container');
  el.classList.toggle('show-mode');
  const btn = document.getElementById('show-waiter-btn');
  if (el.classList.contains('show-mode')) {
    btn.textContent = 'Normal View';
    // Hide remove buttons in show mode
    document.querySelectorAll('.pick-item form').forEach(f => f.style.display = 'none');
    document.querySelector('.picks-actions form').style.display = 'none';
  } else {
    btn.textContent = 'Show Waiter';
    document.querySelectorAll('.pick-item form').forEach(f => f.style.display = '');
    document.querySelector('.picks-actions form').style.display = '';
  }
}
</script>
{% endblock %}
